<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Finding Which Campaigns Work - Marketing Effectiveness Dashboard | Lee Yih Ven</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            --primary-color: #403B36;
            --secondary-color: #CBA135;
            --background-color: #FCF9F2;
            --text-color: #2C2C2C;
            --card-background: #FFFFFF;
            --shadow: 0 4px 20px rgba(64, 59, 54, 0.1);
            --gradient: linear-gradient(135deg, #403B36 0%, #5A524B 100%);
            --gold-gradient: linear-gradient(135deg, #CBA135 0%, #E8C55A 100%);
            --high-color: #2E7D32;
            --medium-color: #F57C00;
            --low-color: #C62828;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Poppins', sans-serif;
            background-color: var(--background-color);
            color: var(--text-color);
            line-height: 1.6;
            overflow-x: hidden;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 20px;
        }

        .dashboard-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Header */
        .header {
            background: linear-gradient(135deg, #403B36 0%, #2C2822 100%);
            color: #FCF9F2;
            padding: 40px;
            border-radius: 15px;
            margin-bottom: 30px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.15);
        }

        .header h1 {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 10px;
        }

        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        /* CTA Buttons */
        .cta-buttons {
            display: flex;
            gap: 15px;
            margin-top: 25px;
            flex-wrap: wrap;
        }

        .cta-button {
            padding: 12px 30px;
            border-radius: 8px;
            text-decoration: none;
            font-weight: 600;
            transition: all 0.3s ease;
            display: inline-block;
        }

        .cta-primary {
            background: linear-gradient(135deg, #CBA135 0%, #B8903A 100%);
            color: #403B36;
        }

        .cta-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(203, 161, 53, 0.4);
        }

        .cta-secondary {
            background: transparent;
            border: 2px solid #CBA135;
            color: #FCF9F2;
        }

        .cta-secondary:hover {
            background: rgba(203, 161, 53, 0.1);
        }

        /* Filters Section */
        .filters-section {
            background: white;
            padding: 30px;
            margin: 30px auto;
            border-radius: 15px;
            box-shadow: var(--shadow);
        }

        .filters-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .filter-group {
            display: flex;
            flex-direction: column;
        }

        .filter-group label {
            font-weight: 600;
            margin-bottom: 8px;
            color: var(--primary-color);
        }

        .filter-group select {
            padding: 12px;
            border: 2px solid #E0E0E0;
            border-radius: 8px;
            font-size: 1rem;
            font-family: 'Poppins', sans-serif;
            background-color: white;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .filter-group select:focus {
            outline: none;
            border-color: var(--secondary-color);
        }

        /* Page Navigation */
        .page-navigation {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin: 30px auto;
            flex-wrap: wrap;
        }

        .page-btn {
            padding: 12px 24px;
            background: white;
            border: 2px solid var(--secondary-color);
            border-radius: 8px;
            font-weight: 600;
            color: var(--primary-color);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .page-btn.active {
            background: var(--gold-gradient);
            color: white;
            border-color: var(--secondary-color);
        }

        .page-btn:hover:not(.active) {
            background: rgba(203, 161, 53, 0.1);
        }

        /* Dashboard Page */
        .dashboard-page {
            display: none;
            animation: fadeIn 0.5s ease-in;
        }

        .dashboard-page.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* KPI Cards */
        .kpi-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 30px auto;
        }

        .kpi-card {
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: var(--shadow);
            text-align: center;
            transition: all 0.3s ease;
            border-top: 4px solid var(--secondary-color);
        }

        .kpi-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 30px rgba(64, 59, 54, 0.15);
        }

        .kpi-card h3 {
            font-size: 1rem;
            color: #666;
            margin-bottom: 10px;
            font-weight: 500;
        }

        .kpi-value {
            font-size: 2.5rem;
            font-weight: 700;
            color: var(--primary-color);
            margin-bottom: 5px;
        }

        .kpi-subtitle {
            font-size: 0.9rem;
            color: var(--secondary-color);
            font-weight: 600;
        }

        /* Chart Grid */
        .chart-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(500px, 1fr));
            gap: 30px;
            margin: 30px auto;
        }

        .chart-container {
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: var(--shadow);
        }

        .chart-container h3 {
            color: var(--primary-color);
            margin-bottom: 20px;
            font-size: 1.3rem;
            font-weight: 600;
            border-bottom: 3px solid var(--secondary-color);
            padding-bottom: 10px;
        }

        .chart-container.full-width {
            grid-column: 1 / -1;
        }

        /* Table Styles */
        .table-container {
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: var(--shadow);
            margin: 30px auto;
            overflow-x: auto;
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.95rem;
        }

        .data-table thead {
            background: var(--gradient);
            color: white;
        }

        .data-table th {
            padding: 15px;
            text-align: left;
            font-weight: 600;
            cursor: pointer;
            user-select: none;
        }

        .data-table th:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        .data-table td {
            padding: 12px 15px;
            border-bottom: 1px solid #E0E0E0;
        }

        .data-table tbody tr:hover {
            background-color: rgba(203, 161, 53, 0.1);
        }

        .uplift-badge {
            padding: 5px 10px;
            border-radius: 20px;
            font-weight: 600;
            font-size: 0.85rem;
            display: inline-block;
        }

        .uplift-high {
            background: #E8F5E9;
            color: var(--high-color);
        }

        .uplift-medium {
            background: #FFF3E0;
            color: var(--medium-color);
        }

        .uplift-low {
            background: #FFEBEE;
            color: var(--low-color);
        }

        /* Footer */
        .footer {
            background: var(--gradient);
            color: white;
            text-align: center;
            padding: 30px 20px;
            margin-top: 60px;
        }

        .footer p {
            margin: 5px 0;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .hero h1 {
                font-size: 2rem;
            }

            .chart-grid {
                grid-template-columns: 1fr;
            }

            .kpi-grid {
                grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            }

            .filters-grid {
                grid-template-columns: 1fr;
            }
        }

        .no-data {
            text-align: center;
            padding: 60px 20px;
            color: #666;
            font-size: 1.1rem;
        }

        .sort-indicator {
            margin-left: 5px;
            font-size: 0.8rem;
        }
    </style>
</head>
<body>
    <div class="dashboard-container">
        <!-- Header -->
        <div class="header">
            <h1>Finding Which Campaigns Work</h1>
            <p>Marketing Effectiveness Dashboard - Identify Which Channels, Objectives, and Segments Deliver the Highest Marketing Uplift</p>
            <div class="cta-buttons">
                <a href="https://www.pauanalytics.com/case-study/finding-which-campaign-work.html" class="cta-button cta-primary">View Full Case Study</a>
                <a href="https://www.pauanalytics.com/data-analytics.html" class="cta-button cta-secondary">More Case Studies</a>
            </div>
        </div>

    <!-- Filters Section -->
    <div class="container">
        <div class="filters-section">
            <h2 style="color: var(--primary-color); margin-bottom: 10px;">Dashboard Filters</h2>
            <p style="color: #666; margin-bottom: 20px;">Filter campaigns to explore specific channels, objectives, or segments</p>
            <div class="filters-grid">
                <div class="filter-group">
                    <label for="channelFilter">Channel</label>
                    <select id="channelFilter">
                        <option value="all">All Channels</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label for="objectiveFilter">Objective</label>
                    <select id="objectiveFilter">
                        <option value="all">All Objectives</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label for="segmentFilter">Target Segment</label>
                    <select id="segmentFilter">
                        <option value="all">All Segments</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label for="upliftFilter">Uplift Category</label>
                    <select id="upliftFilter">
                        <option value="all">All Categories</option>
                        <option value="High">High (≥12%)</option>
                        <option value="Medium">Medium (8-12%)</option>
                        <option value="Low">Low (<8%)</option>
                    </select>
                </div>
            </div>
        </div>

        <!-- Page Navigation -->
        <div class="page-navigation">
            <button class="page-btn active" onclick="showPage(1)">Overview</button>
            <button class="page-btn" onclick="showPage(2)">Channel & Objective Deep Dive</button>
            <button class="page-btn" onclick="showPage(3)">Temporal Trends</button>
            <button class="page-btn" onclick="showPage(4)">Segment Performance</button>
        </div>

        <!-- Page 1: Campaign Overview -->
        <div id="page1" class="dashboard-page active">
            <div class="kpi-grid">
                <div class="kpi-card">
                    <h3>Total Campaigns</h3>
                    <div class="kpi-value" id="kpi-total">0</div>
                    <div class="kpi-subtitle">Campaigns Analyzed</div>
                </div>
                <div class="kpi-card">
                    <h3>Avg Expected Uplift</h3>
                    <div class="kpi-value" id="kpi-avg-uplift">0%</div>
                    <div class="kpi-subtitle">Portfolio Average</div>
                </div>
                <div class="kpi-card">
                    <h3>Best Channel</h3>
                    <div class="kpi-value" id="kpi-best-channel" style="font-size: 1.8rem;">-</div>
                    <div class="kpi-subtitle" id="kpi-best-channel-uplift">-</div>
                </div>
                <div class="kpi-card">
                    <h3>Best Objective</h3>
                    <div class="kpi-value" id="kpi-best-objective" style="font-size: 1.8rem;">-</div>
                    <div class="kpi-subtitle" id="kpi-best-objective-uplift">-</div>
                </div>
            </div>

            <div class="chart-grid">
                <div class="chart-container">
                    <h3>Campaign Distribution by Channel</h3>
                    <canvas id="channelPieChart"></canvas>
                </div>
                <div class="chart-container">
                    <h3>Top 5 Campaigns by Expected Uplift</h3>
                    <canvas id="topCampaignsChart"></canvas>
                </div>
                <div class="chart-container full-width">
                    <h3>Expected Uplift by Objective Across Channels</h3>
                    <canvas id="objectiveChannelChart"></canvas>
                </div>
            </div>
        </div>

        <!-- Page 2: Channel & Objective Deep Dive -->
        <div id="page2" class="dashboard-page">
            <div class="chart-grid">
                <div class="chart-container">
                    <h3>Average Uplift by Channel</h3>
                    <canvas id="channelUpliftChart"></canvas>
                </div>
                <div class="chart-container">
                    <h3>Average Uplift by Objective</h3>
                    <canvas id="objectiveUpliftChart"></canvas>
                </div>
            </div>

            <div class="table-container">
                <h3 style="color: var(--primary-color); margin-bottom: 20px; font-size: 1.3rem; border-bottom: 3px solid var(--secondary-color); padding-bottom: 10px;">Campaign Performance Table</h3>
                <table class="data-table" id="campaignTable">
                    <thead>
                        <tr>
                            <th onclick="sortTable(0)">Campaign ID <span class="sort-indicator">▼</span></th>
                            <th onclick="sortTable(1)">Channel <span class="sort-indicator"></span></th>
                            <th onclick="sortTable(2)">Objective <span class="sort-indicator"></span></th>
                            <th onclick="sortTable(3)">Segment <span class="sort-indicator"></span></th>
                            <th onclick="sortTable(4)">Duration (Days) <span class="sort-indicator"></span></th>
                            <th onclick="sortTable(5)">Expected Uplift <span class="sort-indicator"></span></th>
                            <th onclick="sortTable(6)">Category <span class="sort-indicator"></span></th>
                        </tr>
                    </thead>
                    <tbody id="campaignTableBody">
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Page 3: Temporal Trends -->
        <div id="page3" class="dashboard-page">
            <div class="chart-grid">
                <div class="chart-container">
                    <h3>Campaigns Launched Over Time</h3>
                    <canvas id="campaignsOverTimeChart"></canvas>
                </div>
                <div class="chart-container">
                    <h3>Average Expected Uplift Trend</h3>
                    <canvas id="upliftTrendChart"></canvas>
                </div>
                <div class="chart-container full-width">
                    <h3>Campaign Mix by Quarter</h3>
                    <canvas id="quarterlyMixChart"></canvas>
                </div>
                <div class="chart-container full-width">
                    <h3>Campaign Duration Trend</h3>
                    <canvas id="durationTrendChart"></canvas>
                </div>
            </div>
        </div>

        <!-- Page 4: Segment Performance -->
        <div id="page4" class="dashboard-page">
            <div class="kpi-grid">
                <div class="kpi-card">
                    <h3>Total Segments</h3>
                    <div class="kpi-value" id="kpi-total-segments">0</div>
                    <div class="kpi-subtitle">Unique Segments</div>
                </div>
                <div class="kpi-card">
                    <h3>Best Segment</h3>
                    <div class="kpi-value" id="kpi-best-segment" style="font-size: 1.5rem;">-</div>
                    <div class="kpi-subtitle" id="kpi-best-segment-uplift">-</div>
                </div>
            </div>

            <div class="chart-grid">
                <div class="chart-container">
                    <h3>Campaign Count by Target Segment</h3>
                    <canvas id="segmentCountChart"></canvas>
                </div>
                <div class="chart-container">
                    <h3>Average Uplift by Target Segment</h3>
                    <canvas id="segmentUpliftChart"></canvas>
                </div>
            </div>

            <div class="table-container">
                <h3 style="color: var(--primary-color); margin-bottom: 20px; font-size: 1.3rem; border-bottom: 3px solid var(--secondary-color); padding-bottom: 10px;">Top 10 Campaigns by Uplift</h3>
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Rank</th>
                            <th>Campaign ID</th>
                            <th>Channel</th>
                            <th>Objective</th>
                            <th>Target Segment</th>
                            <th>Expected Uplift</th>
                            <th>Duration</th>
                        </tr>
                    </thead>
                    <tbody id="topCampaignsTableBody">
                    </tbody>
                </table>
            </div>
        </div>
    </div>

        <!-- Footer -->
        <div class="footer">
            <p>&copy; 2024 Pau Analytics | Data-Driven Marketing Intelligence</p>
        </div>
    </div>

    <script>
        // Campaign Data (Embedded from dataset)
        const campaignData = [
            {id:1,channel:"Paid Search",objective:"Cross-sell",segment:"Deal Seekers",start:"2021-10-25",end:"2021-11-26",uplift:0.022,uplift_pct:2.2,duration:32,year:2021,quarter:4,year_quarter:"2021-Q4",month:10,month_name:"October",year_month:"2021-10",category:"Low",combo:"Paid Search - Cross-sell"},
            {id:2,channel:"Email",objective:"Retention",segment:"Deal Seekers",start:"2021-10-24",end:"2021-12-24",uplift:0.116,uplift_pct:11.6,duration:61,year:2021,quarter:4,year_quarter:"2021-Q4",month:10,month_name:"October",year_month:"2021-10",category:"Medium",combo:"Email - Retention"},
            {id:3,channel:"Email",objective:"Reactivation",segment:"Churn Risk",start:"2023-10-08",end:"2023-11-30",uplift:0.1,uplift_pct:10.0,duration:53,year:2023,quarter:4,year_quarter:"2023-Q4",month:10,month_name:"October",year_month:"2023-10",category:"Medium",combo:"Email - Reactivation"},
            {id:4,channel:"Display",objective:"Reactivation",segment:"Deal Seekers",start:"2022-07-25",end:"2022-10-07",uplift:0.111,uplift_pct:11.1,duration:74,year:2022,quarter:3,year_quarter:"2022-Q3",month:7,month_name:"July",year_month:"2022-07",category:"Medium",combo:"Display - Reactivation"},
            {id:5,channel:"Social",objective:"Acquisition",segment:"New Customers",start:"2022-07-09",end:"2022-09-29",uplift:0.144,uplift_pct:14.4,duration:82,year:2022,quarter:3,year_quarter:"2022-Q3",month:7,month_name:"July",year_month:"2022-07",category:"High",combo:"Social - Acquisition"},
            {id:6,channel:"Affiliate",objective:"Reactivation",segment:"New Customers",start:"2021-10-20",end:"2021-12-03",uplift:0.087,uplift_pct:8.7,duration:44,year:2021,quarter:4,year_quarter:"2021-Q4",month:10,month_name:"October",year_month:"2021-10",category:"Medium",combo:"Affiliate - Reactivation"},
            {id:7,channel:"Paid Search",objective:"Cross-sell",segment:"High Value",start:"2023-07-02",end:"2023-08-10",uplift:0.136,uplift_pct:13.6,duration:39,year:2023,quarter:3,year_quarter:"2023-Q3",month:7,month_name:"July",year_month:"2023-07",category:"High",combo:"Paid Search - Cross-sell"},
            {id:8,channel:"Paid Search",objective:"Cross-sell",segment:"Churn Risk",start:"2021-08-23",end:"2021-09-30",uplift:0.128,uplift_pct:12.8,duration:38,year:2021,quarter:3,year_quarter:"2021-Q3",month:8,month_name:"August",year_month:"2021-08",category:"High",combo:"Paid Search - Cross-sell"},
            {id:9,channel:"Social",objective:"Retention",segment:"All",start:"2023-10-09",end:"2023-12-30",uplift:0.113,uplift_pct:11.3,duration:82,year:2023,quarter:4,year_quarter:"2023-Q4",month:10,month_name:"October",year_month:"2023-10",category:"Medium",combo:"Social - Retention"},
            {id:10,channel:"Email",objective:"Cross-sell",segment:"Churn Risk",start:"2022-09-01",end:"2022-10-22",uplift:0.034,uplift_pct:3.4,duration:51,year:2022,quarter:3,year_quarter:"2022-Q3",month:9,month_name:"September",year_month:"2022-09",category:"Low",combo:"Email - Cross-sell"},
            {id:11,channel:"Affiliate",objective:"Reactivation",segment:"Churn Risk",start:"2022-11-02",end:"2023-01-14",uplift:0.104,uplift_pct:10.4,duration:73,year:2022,quarter:4,year_quarter:"2022-Q4",month:11,month_name:"November",year_month:"2022-11",category:"Medium",combo:"Affiliate - Reactivation"},
            {id:12,channel:"Email",objective:"Acquisition",segment:"Churn Risk",start:"2021-01-20",end:"2021-02-21",uplift:0.032,uplift_pct:3.2,duration:32,year:2021,quarter:1,year_quarter:"2021-Q1",month:1,month_name:"January",year_month:"2021-01",category:"Low",combo:"Email - Acquisition"},
            {id:13,channel:"Display",objective:"Reactivation",segment:"Churn Risk",start:"2022-03-19",end:"2022-06-09",uplift:0.063,uplift_pct:6.3,duration:82,year:2022,quarter:1,year_quarter:"2022-Q1",month:3,month_name:"March",year_month:"2022-03",category:"Low",combo:"Display - Reactivation"},
            {id:14,channel:"Email",objective:"Retention",segment:"High Value",start:"2022-09-20",end:"2022-09-29",uplift:0.092,uplift_pct:9.2,duration:9,year:2022,quarter:3,year_quarter:"2022-Q3",month:9,month_name:"September",year_month:"2022-09",category:"Medium",combo:"Email - Retention"},
            {id:15,channel:"Social",objective:"Retention",segment:"New Customers",start:"2022-04-29",end:"2022-05-10",uplift:0.086,uplift_pct:8.6,duration:11,year:2022,quarter:2,year_quarter:"2022-Q2",month:4,month_name:"April",year_month:"2022-04",category:"Medium",combo:"Social - Retention"},
            {id:16,channel:"Email",objective:"Reactivation",segment:"All",start:"2023-08-10",end:"2023-10-15",uplift:0.118,uplift_pct:11.8,duration:66,year:2023,quarter:3,year_quarter:"2023-Q3",month:8,month_name:"August",year_month:"2023-08",category:"Medium",combo:"Email - Reactivation"},
            {id:17,channel:"Display",objective:"Retention",segment:"High Value",start:"2023-04-05",end:"2023-04-24",uplift:0.14,uplift_pct:14.0,duration:19,year:2023,quarter:2,year_quarter:"2023-Q2",month:4,month_name:"April",year_month:"2023-04",category:"High",combo:"Display - Retention"},
            {id:18,channel:"Affiliate",objective:"Retention",segment:"All",start:"2022-10-09",end:"2022-12-07",uplift:0.139,uplift_pct:13.9,duration:59,year:2022,quarter:4,year_quarter:"2022-Q4",month:10,month_name:"October",year_month:"2022-10",category:"High",combo:"Affiliate - Retention"},
            {id:19,channel:"Affiliate",objective:"Acquisition",segment:"New Customers",start:"2021-11-28",end:"2022-01-29",uplift:0.087,uplift_pct:8.7,duration:62,year:2021,quarter:4,year_quarter:"2021-Q4",month:11,month_name:"November",year_month:"2021-11",category:"Medium",combo:"Affiliate - Acquisition"},
            {id:20,channel:"Social",objective:"Reactivation",segment:"New Customers",start:"2021-07-26",end:"2021-09-23",uplift:0.059,uplift_pct:5.9,duration:59,year:2021,quarter:3,year_quarter:"2021-Q3",month:7,month_name:"July",year_month:"2021-07",category:"Low",combo:"Social - Reactivation"},
            {id:21,channel:"Email",objective:"Acquisition",segment:"Churn Risk",start:"2023-02-21",end:"2023-03-27",uplift:0.09,uplift_pct:9.0,duration:34,year:2023,quarter:1,year_quarter:"2023-Q1",month:2,month_name:"February",year_month:"2023-02",category:"Medium",combo:"Email - Acquisition"},
            {id:22,channel:"Affiliate",objective:"Reactivation",segment:"High Value",start:"2022-07-02",end:"2022-09-18",uplift:0.038,uplift_pct:3.8,duration:78,year:2022,quarter:3,year_quarter:"2022-Q3",month:7,month_name:"July",year_month:"2022-07",category:"Low",combo:"Affiliate - Reactivation"},
            {id:23,channel:"Paid Search",objective:"Retention",segment:"Deal Seekers",start:"2022-10-25",end:"2023-01-19",uplift:0.107,uplift_pct:10.7,duration:86,year:2022,quarter:4,year_quarter:"2022-Q4",month:10,month_name:"October",year_month:"2022-10",category:"Medium",combo:"Paid Search - Retention"},
            {id:24,channel:"Display",objective:"Acquisition",segment:"New Customers",start:"2021-11-07",end:"2022-01-06",uplift:0.063,uplift_pct:6.3,duration:60,year:2021,quarter:4,year_quarter:"2021-Q4",month:11,month_name:"November",year_month:"2021-11",category:"Low",combo:"Display - Acquisition"},
            {id:25,channel:"Paid Search",objective:"Cross-sell",segment:"High Value",start:"2021-03-19",end:"2021-04-11",uplift:0.119,uplift_pct:11.9,duration:23,year:2021,quarter:1,year_quarter:"2021-Q1",month:3,month_name:"March",year_month:"2021-03",category:"Medium",combo:"Paid Search - Cross-sell"},
            {id:26,channel:"Email",objective:"Reactivation",segment:"Deal Seekers",start:"2023-08-13",end:"2023-11-01",uplift:0.037,uplift_pct:3.7,duration:80,year:2023,quarter:3,year_quarter:"2023-Q3",month:8,month_name:"August",year_month:"2023-08",category:"Low",combo:"Email - Reactivation"},
            {id:27,channel:"Display",objective:"Retention",segment:"New Customers",start:"2022-04-01",end:"2022-04-11",uplift:0.057,uplift_pct:5.7,duration:10,year:2022,quarter:2,year_quarter:"2022-Q2",month:4,month_name:"April",year_month:"2022-04",category:"Low",combo:"Display - Retention"},
            {id:28,channel:"Affiliate",objective:"Acquisition",segment:"New Customers",start:"2021-09-02",end:"2021-09-11",uplift:0.093,uplift_pct:9.3,duration:9,year:2021,quarter:3,year_quarter:"2021-Q3",month:9,month_name:"September",year_month:"2021-09",category:"Medium",combo:"Affiliate - Acquisition"},
            {id:29,channel:"Email",objective:"Acquisition",segment:"New Customers",start:"2021-12-26",end:"2022-02-26",uplift:0.14,uplift_pct:14.0,duration:62,year:2021,quarter:4,year_quarter:"2021-Q4",month:12,month_name:"December",year_month:"2021-12",category:"High",combo:"Email - Acquisition"},
            {id:30,channel:"Social",objective:"Acquisition",segment:"Deal Seekers",start:"2023-11-04",end:"2024-01-06",uplift:0.052,uplift_pct:5.2,duration:63,year:2023,quarter:4,year_quarter:"2023-Q4",month:11,month_name:"November",year_month:"2023-11",category:"Low",combo:"Social - Acquisition"},
            {id:31,channel:"Affiliate",objective:"Cross-sell",segment:"High Value",start:"2023-10-26",end:"2023-12-03",uplift:0.108,uplift_pct:10.8,duration:38,year:2023,quarter:4,year_quarter:"2023-Q4",month:10,month_name:"October",year_month:"2023-10",category:"Medium",combo:"Affiliate - Cross-sell"},
            {id:32,channel:"Social",objective:"Reactivation",segment:"Churn Risk",start:"2021-08-05",end:"2021-10-16",uplift:0.051,uplift_pct:5.1,duration:72,year:2021,quarter:3,year_quarter:"2021-Q3",month:8,month_name:"August",year_month:"2021-08",category:"Low",combo:"Social - Reactivation"},
            {id:33,channel:"Display",objective:"Cross-sell",segment:"All",start:"2022-02-15",end:"2022-04-18",uplift:0.1,uplift_pct:10.0,duration:62,year:2022,quarter:1,year_quarter:"2022-Q1",month:2,month_name:"February",year_month:"2022-02",category:"Medium",combo:"Display - Cross-sell"},
            {id:34,channel:"Email",objective:"Reactivation",segment:"Churn Risk",start:"2023-03-19",end:"2023-05-13",uplift:0.042,uplift_pct:4.2,duration:55,year:2023,quarter:1,year_quarter:"2023-Q1",month:3,month_name:"March",year_month:"2023-03",category:"Low",combo:"Email - Reactivation"},
            {id:35,channel:"Display",objective:"Acquisition",segment:"High Value",start:"2022-11-06",end:"2022-11-26",uplift:0.046,uplift_pct:4.6,duration:20,year:2022,quarter:4,year_quarter:"2022-Q4",month:11,month_name:"November",year_month:"2022-11",category:"Low",combo:"Display - Acquisition"},
            {id:36,channel:"Display",objective:"Reactivation",segment:"Deal Seekers",start:"2023-04-03",end:"2023-06-10",uplift:0.117,uplift_pct:11.7,duration:68,year:2023,quarter:2,year_quarter:"2023-Q2",month:4,month_name:"April",year_month:"2023-04",category:"Medium",combo:"Display - Reactivation"},
            {id:37,channel:"Paid Search",objective:"Cross-sell",segment:"Deal Seekers",start:"2022-10-20",end:"2022-12-01",uplift:0.096,uplift_pct:9.6,duration:42,year:2022,quarter:4,year_quarter:"2022-Q4",month:10,month_name:"October",year_month:"2022-10",category:"Medium",combo:"Paid Search - Cross-sell"},
            {id:38,channel:"Paid Search",objective:"Reactivation",segment:"All",start:"2021-12-18",end:"2022-01-31",uplift:0.065,uplift_pct:6.5,duration:44,year:2021,quarter:4,year_quarter:"2021-Q4",month:12,month_name:"December",year_month:"2021-12",category:"Low",combo:"Paid Search - Reactivation"},
            {id:39,channel:"Affiliate",objective:"Retention",segment:"New Customers",start:"2023-03-08",end:"2023-05-11",uplift:0.108,uplift_pct:10.8,duration:64,year:2023,quarter:1,year_quarter:"2023-Q1",month:3,month_name:"March",year_month:"2023-03",category:"Medium",combo:"Affiliate - Retention"},
            {id:40,channel:"Display",objective:"Cross-sell",segment:"New Customers",start:"2022-07-25",end:"2022-09-07",uplift:0.105,uplift_pct:10.5,duration:44,year:2022,quarter:3,year_quarter:"2022-Q3",month:7,month_name:"July",year_month:"2022-07",category:"Medium",combo:"Display - Cross-sell"},
            {id:41,channel:"Social",objective:"Retention",segment:"All",start:"2023-04-09",end:"2023-04-17",uplift:0.058,uplift_pct:5.8,duration:8,year:2023,quarter:2,year_quarter:"2023-Q2",month:4,month_name:"April",year_month:"2023-04",category:"Low",combo:"Social - Retention"},
            {id:42,channel:"Paid Search",objective:"Retention",segment:"High Value",start:"2023-04-22",end:"2023-06-29",uplift:0.051,uplift_pct:5.1,duration:68,year:2023,quarter:2,year_quarter:"2023-Q2",month:4,month_name:"April",year_month:"2023-04",category:"Low",combo:"Paid Search - Retention"},
            {id:43,channel:"Paid Search",objective:"Cross-sell",segment:"Deal Seekers",start:"2023-03-12",end:"2023-04-18",uplift:0.078,uplift_pct:7.8,duration:37,year:2023,quarter:1,year_quarter:"2023-Q1",month:3,month_name:"March",year_month:"2023-03",category:"Low",combo:"Paid Search - Cross-sell"},
            {id:44,channel:"Affiliate",objective:"Reactivation",segment:"All",start:"2021-01-31",end:"2021-04-17",uplift:0.141,uplift_pct:14.1,duration:76,year:2021,quarter:1,year_quarter:"2021-Q1",month:1,month_name:"January",year_month:"2021-01",category:"High",combo:"Affiliate - Reactivation"},
            {id:45,channel:"Affiliate",objective:"Retention",segment:"Churn Risk",start:"2022-04-08",end:"2022-06-15",uplift:0.114,uplift_pct:11.4,duration:68,year:2022,quarter:2,year_quarter:"2022-Q2",month:4,month_name:"April",year_month:"2022-04",category:"Medium",combo:"Affiliate - Retention"},
            {id:46,channel:"Social",objective:"Cross-sell",segment:"All",start:"2023-03-23",end:"2023-04-17",uplift:0.03,uplift_pct:3.0,duration:25,year:2023,quarter:1,year_quarter:"2023-Q1",month:3,month_name:"March",year_month:"2023-03",category:"Low",combo:"Social - Cross-sell"},
            {id:47,channel:"Affiliate",objective:"Cross-sell",segment:"High Value",start:"2022-04-12",end:"2022-06-04",uplift:0.066,uplift_pct:6.6,duration:53,year:2022,quarter:2,year_quarter:"2022-Q2",month:4,month_name:"April",year_month:"2022-04",category:"Low",combo:"Affiliate - Cross-sell"},
            {id:48,channel:"Paid Search",objective:"Acquisition",segment:"New Customers",start:"2022-01-05",end:"2022-04-04",uplift:0.099,uplift_pct:9.9,duration:89,year:2022,quarter:1,year_quarter:"2022-Q1",month:1,month_name:"January",year_month:"2022-01",category:"Medium",combo:"Paid Search - Acquisition"},
            {id:49,channel:"Paid Search",objective:"Reactivation",segment:"Deal Seekers",start:"2021-04-09",end:"2021-05-24",uplift:0.128,uplift_pct:12.8,duration:45,year:2021,quarter:2,year_quarter:"2021-Q2",month:4,month_name:"April",year_month:"2021-04",category:"High",combo:"Paid Search - Reactivation"},
            {id:50,channel:"Email",objective:"Retention",segment:"Churn Risk",start:"2021-02-14",end:"2021-03-24",uplift:0.023,uplift_pct:2.3,duration:38,year:2021,quarter:1,year_quarter:"2021-Q1",month:2,month_name:"February",year_month:"2021-02",category:"Low",combo:"Email - Retention"}
        ];

        let filteredData = [...campaignData];
        let charts = {};
        let sortColumn = 0;
        let sortAscending = false;

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            populateFilters();
            attachFilterListeners();
            updateDashboard();
        });

        function populateFilters() {
            const channels = [...new Set(campaignData.map(c => c.channel))].sort();
            const objectives = [...new Set(campaignData.map(c => c.objective))].sort();
            const segments = [...new Set(campaignData.map(c => c.segment))].sort();

            const channelFilter = document.getElementById('channelFilter');
            const objectiveFilter = document.getElementById('objectiveFilter');
            const segmentFilter = document.getElementById('segmentFilter');

            channels.forEach(ch => {
                channelFilter.innerHTML += `<option value="${ch}">${ch}</option>`;
            });

            objectives.forEach(obj => {
                objectiveFilter.innerHTML += `<option value="${obj}">${obj}</option>`;
            });

            segments.forEach(seg => {
                segmentFilter.innerHTML += `<option value="${seg}">${seg}</option>`;
            });
        }

        function attachFilterListeners() {
            ['channelFilter', 'objectiveFilter', 'segmentFilter', 'upliftFilter'].forEach(id => {
                document.getElementById(id).addEventListener('change', applyFilters);
            });
        }

        function applyFilters() {
            const channel = document.getElementById('channelFilter').value;
            const objective = document.getElementById('objectiveFilter').value;
            const segment = document.getElementById('segmentFilter').value;
            const uplift = document.getElementById('upliftFilter').value;

            filteredData = campaignData.filter(c => {
                return (channel === 'all' || c.channel === channel) &&
                       (objective === 'all' || c.objective === objective) &&
                       (segment === 'all' || c.segment === segment) &&
                       (uplift === 'all' || c.category === uplift);
            });

            updateDashboard();
        }

        function updateDashboard() {
            updateKPIs();
            updatePage1Charts();
            updatePage2();
            updatePage3Charts();
            updatePage4();
        }

        function updateKPIs() {
            // Page 1 KPIs
            const totalCampaigns = filteredData.length;
            const avgUplift = filteredData.reduce((sum, c) => sum + c.uplift_pct, 0) / totalCampaigns;

            // Best Channel
            const channelStats = {};
            filteredData.forEach(c => {
                if (!channelStats[c.channel]) channelStats[c.channel] = {sum: 0, count: 0};
                channelStats[c.channel].sum += c.uplift_pct;
                channelStats[c.channel].count++;
            });
            const bestChannel = Object.keys(channelStats).reduce((best, ch) => {
                const avg = channelStats[ch].sum / channelStats[ch].count;
                return avg > (channelStats[best]?.sum / channelStats[best]?.count || 0) ? ch : best;
            }, Object.keys(channelStats)[0]);

            // Best Objective
            const objectiveStats = {};
            filteredData.forEach(c => {
                if (!objectiveStats[c.objective]) objectiveStats[c.objective] = {sum: 0, count: 0};
                objectiveStats[c.objective].sum += c.uplift_pct;
                objectiveStats[c.objective].count++;
            });
            const bestObjective = Object.keys(objectiveStats).reduce((best, obj) => {
                const avg = objectiveStats[obj].sum / objectiveStats[obj].count;
                return avg > (objectiveStats[best]?.sum / objectiveStats[best]?.count || 0) ? obj : best;
            }, Object.keys(objectiveStats)[0]);

            document.getElementById('kpi-total').textContent = totalCampaigns;
            document.getElementById('kpi-avg-uplift').textContent = avgUplift.toFixed(1) + '%';
            document.getElementById('kpi-best-channel').textContent = bestChannel || '-';
            document.getElementById('kpi-best-channel-uplift').textContent = bestChannel ?
                `${(channelStats[bestChannel].sum / channelStats[bestChannel].count).toFixed(1)}% avg uplift` : '-';
            document.getElementById('kpi-best-objective').textContent = bestObjective || '-';
            document.getElementById('kpi-best-objective-uplift').textContent = bestObjective ?
                `${(objectiveStats[bestObjective].sum / objectiveStats[bestObjective].count).toFixed(1)}% avg uplift` : '-';

            // Page 4 KPIs
            const segments = [...new Set(filteredData.map(c => c.segment))];
            document.getElementById('kpi-total-segments').textContent = segments.length;

            const segmentStats = {};
            filteredData.forEach(c => {
                if (!segmentStats[c.segment]) segmentStats[c.segment] = {sum: 0, count: 0};
                segmentStats[c.segment].sum += c.uplift_pct;
                segmentStats[c.segment].count++;
            });
            const bestSegment = Object.keys(segmentStats).reduce((best, seg) => {
                const avg = segmentStats[seg].sum / segmentStats[seg].count;
                return avg > (segmentStats[best]?.sum / segmentStats[best]?.count || 0) ? seg : best;
            }, Object.keys(segmentStats)[0]);

            document.getElementById('kpi-best-segment').textContent = bestSegment || '-';
            document.getElementById('kpi-best-segment-uplift').textContent = bestSegment ?
                `${(segmentStats[bestSegment].sum / segmentStats[bestSegment].count).toFixed(1)}% avg uplift` : '-';
        }

        function updatePage1Charts() {
            // Channel Pie Chart
            const channelCounts = {};
            filteredData.forEach(c => {
                channelCounts[c.channel] = (channelCounts[c.channel] || 0) + 1;
            });

            destroyChart('channelPieChart');
            charts.channelPie = new Chart(document.getElementById('channelPieChart'), {
                type: 'pie',
                data: {
                    labels: Object.keys(channelCounts),
                    datasets: [{
                        data: Object.values(channelCounts),
                        backgroundColor: ['#403B36', '#CBA135', '#5A524B', '#E8C55A', '#8B7355']
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {position: 'bottom'},
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    const total = context.dataset.data.reduce((a, b) => a + b, 0);
                                    const pct = ((context.parsed / total) * 100).toFixed(1);
                                    return `${context.label}: ${context.parsed} (${pct}%)`;
                                }
                            }
                        }
                    }
                }
            });

            // Top 5 Campaigns
            const top5 = [...filteredData].sort((a, b) => b.uplift_pct - a.uplift_pct).slice(0, 5);
            destroyChart('topCampaignsChart');
            charts.topCampaigns = new Chart(document.getElementById('topCampaignsChart'), {
                type: 'bar',
                data: {
                    labels: top5.map(c => `Campaign ${c.id}`),
                    datasets: [{
                        label: 'Expected Uplift (%)',
                        data: top5.map(c => c.uplift_pct),
                        backgroundColor: '#CBA135'
                    }]
                },
                options: {
                    indexAxis: 'y',
                    responsive: true,
                    plugins: {
                        legend: {display: false}
                    },
                    scales: {
                        x: {
                            beginAtZero: true,
                            title: {display: true, text: 'Expected Uplift (%)'}
                        }
                    }
                }
            });

            // Objective-Channel Matrix
            const matrix = {};
            filteredData.forEach(c => {
                if (!matrix[c.objective]) matrix[c.objective] = {};
                if (!matrix[c.objective][c.channel]) matrix[c.objective][c.channel] = {sum: 0, count: 0};
                matrix[c.objective][c.channel].sum += c.uplift_pct;
                matrix[c.objective][c.channel].count++;
            });

            const objectives = Object.keys(matrix).sort();
            const channels = [...new Set(filteredData.map(c => c.channel))].sort();
            const datasets = channels.map((ch, idx) => ({
                label: ch,
                data: objectives.map(obj =>
                    matrix[obj][ch] ? (matrix[obj][ch].sum / matrix[obj][ch].count) : 0
                ),
                backgroundColor: ['#403B36', '#CBA135', '#5A524B', '#E8C55A', '#8B7355'][idx % 5]
            }));

            destroyChart('objectiveChannelChart');
            charts.objectiveChannel = new Chart(document.getElementById('objectiveChannelChart'), {
                type: 'bar',
                data: {
                    labels: objectives,
                    datasets: datasets
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {position: 'top'}
                    },
                    scales: {
                        x: {title: {display: true, text: 'Objective'}},
                        y: {beginAtZero: true, title: {display: true, text: 'Avg Expected Uplift (%)'}}
                    }
                }
            });
        }

        function updatePage2() {
            // Channel Uplift
            const channelStats = {};
            filteredData.forEach(c => {
                if (!channelStats[c.channel]) channelStats[c.channel] = {sum: 0, count: 0};
                channelStats[c.channel].sum += c.uplift_pct;
                channelStats[c.channel].count++;
            });
            const channelLabels = Object.keys(channelStats).sort();
            const channelAvgs = channelLabels.map(ch => channelStats[ch].sum / channelStats[ch].count);

            destroyChart('channelUpliftChart');
            charts.channelUplift = new Chart(document.getElementById('channelUpliftChart'), {
                type: 'bar',
                data: {
                    labels: channelLabels,
                    datasets: [{
                        label: 'Avg Expected Uplift (%)',
                        data: channelAvgs,
                        backgroundColor: channelAvgs.map(v => v >= 10 ? '#2E7D32' : v >= 8 ? '#F57C00' : '#C62828')
                    }]
                },
                options: {
                    indexAxis: 'y',
                    responsive: true,
                    plugins: {
                        legend: {display: false},
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return `Avg Uplift: ${context.parsed.x.toFixed(1)}%`;
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            beginAtZero: true,
                            title: {display: true, text: 'Average Expected Uplift (%)'}
                        }
                    }
                }
            });

            // Objective Uplift
            const objectiveStats = {};
            filteredData.forEach(c => {
                if (!objectiveStats[c.objective]) objectiveStats[c.objective] = {sum: 0, count: 0};
                objectiveStats[c.objective].sum += c.uplift_pct;
                objectiveStats[c.objective].count++;
            });
            const objectiveLabels = Object.keys(objectiveStats).sort();
            const objectiveAvgs = objectiveLabels.map(obj => objectiveStats[obj].sum / objectiveStats[obj].count);

            destroyChart('objectiveUpliftChart');
            charts.objectiveUplift = new Chart(document.getElementById('objectiveUpliftChart'), {
                type: 'bar',
                data: {
                    labels: objectiveLabels,
                    datasets: [{
                        label: 'Avg Expected Uplift (%)',
                        data: objectiveAvgs,
                        backgroundColor: objectiveAvgs.map(v => v >= 10 ? '#2E7D32' : v >= 8 ? '#F57C00' : '#C62828')
                    }]
                },
                options: {
                    indexAxis: 'y',
                    responsive: true,
                    plugins: {
                        legend: {display: false}
                    },
                    scales: {
                        x: {
                            beginAtZero: true,
                            title: {display: true, text: 'Average Expected Uplift (%)'}
                        }
                    }
                }
            });

            // Campaign Table
            const tbody = document.getElementById('campaignTableBody');
            tbody.innerHTML = '';
            filteredData.forEach(c => {
                const row = `<tr>
                    <td>${c.id}</td>
                    <td>${c.channel}</td>
                    <td>${c.objective}</td>
                    <td>${c.segment}</td>
                    <td>${c.duration}</td>
                    <td>${c.uplift_pct.toFixed(1)}%</td>
                    <td><span class="uplift-badge uplift-${c.category.toLowerCase()}">${c.category}</span></td>
                </tr>`;
                tbody.innerHTML += row;
            });
        }

        function updatePage3Charts() {
            // Campaigns Over Time
            const monthCounts = {};
            filteredData.forEach(c => {
                monthCounts[c.year_month] = (monthCounts[c.year_month] || 0) + 1;
            });
            const months = Object.keys(monthCounts).sort();
            const counts = months.map(m => monthCounts[m]);

            destroyChart('campaignsOverTimeChart');
            charts.campaignsTime = new Chart(document.getElementById('campaignsOverTimeChart'), {
                type: 'line',
                data: {
                    labels: months,
                    datasets: [{
                        label: 'Campaigns Launched',
                        data: counts,
                        borderColor: '#CBA135',
                        backgroundColor: 'rgba(203, 161, 53, 0.1)',
                        fill: true,
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    scales: {
                        y: {beginAtZero: true, ticks: {stepSize: 1}}
                    }
                }
            });

            // Uplift Trend
            const quarterStats = {};
            filteredData.forEach(c => {
                if (!quarterStats[c.year_quarter]) quarterStats[c.year_quarter] = {sum: 0, count: 0};
                quarterStats[c.year_quarter].sum += c.uplift_pct;
                quarterStats[c.year_quarter].count++;
            });
            const quarters = Object.keys(quarterStats).sort();
            const quarterAvgs = quarters.map(q => quarterStats[q].sum / quarterStats[q].count);

            destroyChart('upliftTrendChart');
            charts.upliftTrend = new Chart(document.getElementById('upliftTrendChart'), {
                type: 'line',
                data: {
                    labels: quarters,
                    datasets: [{
                        label: 'Avg Expected Uplift (%)',
                        data: quarterAvgs,
                        borderColor: '#2E7D32',
                        backgroundColor: 'rgba(46, 125, 50, 0.1)',
                        fill: true,
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    scales: {
                        y: {beginAtZero: true}
                    }
                }
            });

            // Quarterly Mix
            const quarterlyMix = {};
            filteredData.forEach(c => {
                if (!quarterlyMix[c.year_quarter]) quarterlyMix[c.year_quarter] = {};
                quarterlyMix[c.year_quarter][c.objective] = (quarterlyMix[c.year_quarter][c.objective] || 0) + 1;
            });
            const quartersForMix = Object.keys(quarterlyMix).sort();
            const objectives = [...new Set(filteredData.map(c => c.objective))].sort();
            const mixDatasets = objectives.map((obj, idx) => ({
                label: obj,
                data: quartersForMix.map(q => quarterlyMix[q][obj] || 0),
                backgroundColor: ['#403B36', '#CBA135', '#5A524B', '#E8C55A'][idx % 4]
            }));

            destroyChart('quarterlyMixChart');
            charts.quarterlyMix = new Chart(document.getElementById('quarterlyMixChart'), {
                type: 'bar',
                data: {
                    labels: quartersForMix,
                    datasets: mixDatasets
                },
                options: {
                    responsive: true,
                    scales: {
                        x: {stacked: true},
                        y: {stacked: true, beginAtZero: true}
                    }
                }
            });

            // Duration Trend
            const quarterDuration = {};
            filteredData.forEach(c => {
                if (!quarterDuration[c.year_quarter]) quarterDuration[c.year_quarter] = {sum: 0, count: 0};
                quarterDuration[c.year_quarter].sum += c.duration;
                quarterDuration[c.year_quarter].count++;
            });
            const quartersDur = Object.keys(quarterDuration).sort();
            const avgDurations = quartersDur.map(q => quarterDuration[q].sum / quarterDuration[q].count);

            destroyChart('durationTrendChart');
            charts.durationTrend = new Chart(document.getElementById('durationTrendChart'), {
                type: 'line',
                data: {
                    labels: quartersDur,
                    datasets: [{
                        label: 'Avg Campaign Duration (Days)',
                        data: avgDurations,
                        borderColor: '#F57C00',
                        backgroundColor: 'rgba(245, 124, 0, 0.1)',
                        fill: true,
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    scales: {
                        y: {beginAtZero: true}
                    }
                }
            });
        }

        function updatePage4() {
            // Segment Count
            const segmentCounts = {};
            filteredData.forEach(c => {
                segmentCounts[c.segment] = (segmentCounts[c.segment] || 0) + 1;
            });
            const segmentLabels = Object.keys(segmentCounts).sort();
            const segmentCountValues = segmentLabels.map(s => segmentCounts[s]);

            destroyChart('segmentCountChart');
            charts.segmentCount = new Chart(document.getElementById('segmentCountChart'), {
                type: 'bar',
                data: {
                    labels: segmentLabels,
                    datasets: [{
                        label: 'Campaign Count',
                        data: segmentCountValues,
                        backgroundColor: '#403B36'
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {legend: {display: false}},
                    scales: {
                        y: {beginAtZero: true, ticks: {stepSize: 1}}
                    }
                }
            });

            // Segment Uplift
            const segmentStats = {};
            filteredData.forEach(c => {
                if (!segmentStats[c.segment]) segmentStats[c.segment] = {sum: 0, count: 0};
                segmentStats[c.segment].sum += c.uplift_pct;
                segmentStats[c.segment].count++;
            });
            const segmentAvgs = segmentLabels.map(s => segmentStats[s].sum / segmentStats[s].count);

            destroyChart('segmentUpliftChart');
            charts.segmentUplift = new Chart(document.getElementById('segmentUpliftChart'), {
                type: 'bar',
                data: {
                    labels: segmentLabels,
                    datasets: [{
                        label: 'Avg Expected Uplift (%)',
                        data: segmentAvgs,
                        backgroundColor: '#CBA135'
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {legend: {display: false}},
                    scales: {
                        y: {beginAtZero: true}
                    }
                }
            });

            // Top 10 Table
            const top10 = [...filteredData].sort((a, b) => b.uplift_pct - a.uplift_pct).slice(0, 10);
            const tbody = document.getElementById('topCampaignsTableBody');
            tbody.innerHTML = '';
            top10.forEach((c, idx) => {
                const row = `<tr>
                    <td>${idx + 1}</td>
                    <td>${c.id}</td>
                    <td>${c.channel}</td>
                    <td>${c.objective}</td>
                    <td>${c.segment}</td>
                    <td><span class="uplift-badge uplift-${c.category.toLowerCase()}">${c.uplift_pct.toFixed(1)}%</span></td>
                    <td>${c.duration} days</td>
                </tr>`;
                tbody.innerHTML += row;
            });
        }

        function destroyChart(chartId) {
            const chartKey = chartId.replace('Chart', '');
            if (charts[chartKey]) {
                charts[chartKey].destroy();
            }
        }

        function showPage(pageNum) {
            document.querySelectorAll('.dashboard-page').forEach(page => page.classList.remove('active'));
            document.querySelectorAll('.page-btn').forEach(btn => btn.classList.remove('active'));

            document.getElementById(`page${pageNum}`).classList.add('active');
            document.querySelectorAll('.page-btn')[pageNum - 1].classList.add('active');

            // Scroll to top
            window.scrollTo({top: 0, behavior: 'smooth'});
        }

        function sortTable(columnIndex) {
            const table = document.getElementById('campaignTable');
            const tbody = table.querySelector('tbody');
            const rows = Array.from(tbody.querySelectorAll('tr'));

            if (sortColumn === columnIndex) {
                sortAscending = !sortAscending;
            } else {
                sortColumn = columnIndex;
                sortAscending = true;
            }

            rows.sort((a, b) => {
                const aValue = a.cells[columnIndex].textContent.trim();
                const bValue = b.cells[columnIndex].textContent.trim();

                const aNum = parseFloat(aValue.replace('%', '').replace(/[^0-9.-]/g, ''));
                const bNum = parseFloat(bValue.replace('%', '').replace(/[^0-9.-]/g, ''));

                if (!isNaN(aNum) && !isNaN(bNum)) {
                    return sortAscending ? aNum - bNum : bNum - aNum;
                }
                return sortAscending ? aValue.localeCompare(bValue) : bValue.localeCompare(aValue);
            });

            rows.forEach(row => tbody.appendChild(row));

            // Update sort indicators
            document.querySelectorAll('.sort-indicator').forEach(ind => ind.textContent = '');
            const indicator = table.querySelectorAll('th')[columnIndex].querySelector('.sort-indicator');
            indicator.textContent = sortAscending ? '▲' : '▼';
        }
    </script>
</body>
</html>
